/*

PROPRIETARY RIGHTS NOTICE

THIS SOFTWARE PRODUCT IS THE PROPRIETARY PROPERTY OF SRYDEN, 
149 NEW MONTGOMERY ST 4TH FLOOR, SAN FRANCISCO, CA 94105, UNITED STATES ("SRYDEN, INC.").

ALL RIGHT, TITLE, AND INTEREST IN AND TO THIS SOFTWARE PRODUCT AND ANY 
AND ALL COPIES THEREOF, INCLUDING BUT NOT LIMITED TO ALL INTELLECTUAL 
PROPERTY RIGHTS, ARE AND SHALL REMAIN THE EXCLUSIVE PROPERTY OF OWNER.

THIS SOFTWARE PRODUCT IS PROTECTED BY COPYRIGHT LAWS AND INTERNATIONAL 
COPYRIGHT TREATIES, AS WELL AS OTHER INTELLECTUAL PROPERTY LAWS AND 
TREATIES.

UNAUTHORIZED REPRODUCTION, DISPLAY, DISTRIBUTION, OR USE OF THIS SOFTWARE 
PRODUCT OR ANY PORTION THEREOF MAY RESULT IN SEVERE CIVIL AND CRIMINAL 
PENALTIES, AND WILL BE PROSECUTED TO THE MAXIMUM EXTENT POSSIBLE UNDER LAW.

© 2024 SRYDEN, INC. ALL RIGHTS RESERVED.

*/ 

const _0x5d7909=_0x17de;(function(_0xb0f450,_0x24e041){const _0x427e56=_0x17de,_0x455e57=_0xb0f450();while(!![]){try{const _0x5a8174=-parseInt(_0x427e56(0x168))/0x1*(-parseInt(_0x427e56(0x157))/0x2)+-parseInt(_0x427e56(0x18e))/0x3+-parseInt(_0x427e56(0x16e))/0x4*(parseInt(_0x427e56(0x1ae))/0x5)+parseInt(_0x427e56(0x19d))/0x6+-parseInt(_0x427e56(0x1d6))/0x7+-parseInt(_0x427e56(0x14d))/0x8+parseInt(_0x427e56(0x1d8))/0x9;if(_0x5a8174===_0x24e041)break;else _0x455e57['push'](_0x455e57['shift']());}catch(_0x2c8b71){_0x455e57['push'](_0x455e57['shift']());}}}(_0x5d76,0xb4e37));const fs=require(_0x5d7909(0x1ca)),path=require(_0x5d7909(0x185)),axios=require(_0x5d7909(0x14a)),Docker=require(_0x5d7909(0x1b2)),crypto=require(_0x5d7909(0x149)),config=require(_0x5d7909(0x164)),VOLUMES_DIR=config[_0x5d7909(0x1b3)]||_0x5d7909(0x166),STRATEGIES_DIR=path['join'](__dirname,_0x5d7909(0x199)),FLAGGED_CONTAINERS_FILE=_0x5d7909(0x1ad),SCAN_INTERVAL=0x3*0x3c*0x3e8,PUBLIC_WEBHOOK_URL=config['public_whook'],PRIVATE_WEBHOOK_URL=config['private_whook'],PTERODACTYL_API_URL=config[_0x5d7909(0x19a)]+_0x5d7909(0x15e),PTERODACTYL_API_KEY=config[_0x5d7909(0x1ba)],PTERODACTYL_SESSION_COOKIE='none',docker=new Docker();let flaggedContainers={};fs[_0x5d7909(0x1d1)](FLAGGED_CONTAINERS_FILE)&&(flaggedContainers=JSON[_0x5d7909(0x1a1)](fs[_0x5d7909(0x1a0)](FLAGGED_CONTAINERS_FILE,_0x5d7909(0x17d))));async function calculateFileHash(_0xbd77bf){return new Promise((_0x35657b,_0x2b8510)=>{const _0x2369ed=_0x17de,_0x50b23a=crypto[_0x2369ed(0x1a3)]('sha256'),_0x5d31c4=fs[_0x2369ed(0x1a7)](_0xbd77bf);_0x5d31c4['on']('error',_0x2b8510),_0x5d31c4['on'](_0x2369ed(0x158),_0x3fb8ec=>_0x50b23a['update'](_0x3fb8ec)),_0x5d31c4['on'](_0x2369ed(0x1b9),()=>_0x35657b(_0x50b23a[_0x2369ed(0x1bd)]('hex')));});}async function getServerIdFromUUID(_0x585ffc){const _0x2cc5c3=_0x5d7909;try{const _0x472357=await axios[_0x2cc5c3(0x1cc)](PTERODACTYL_API_URL+_0x2cc5c3(0x184),{'headers':{'Accept':_0x2cc5c3(0x171),'Content-Type':_0x2cc5c3(0x171),'Authorization':'Bearer\x20'+PTERODACTYL_API_KEY,'Cookie':PTERODACTYL_SESSION_COOKIE}}),_0x3a33a0=_0x472357['data'][_0x2cc5c3(0x158)]['find'](_0x167a51=>_0x167a51[_0x2cc5c3(0x18d)][_0x2cc5c3(0x1c6)]===_0x585ffc);return _0x3a33a0?_0x3a33a0[_0x2cc5c3(0x18d)]['id']:null;}catch(_0x4ba605){return console[_0x2cc5c3(0x1c5)](_0x2cc5c3(0x1cd),_0x4ba605),null;}}async function suspendServer(_0x354b9c){const _0xcafeb6=_0x5d7909;try{await axios[_0xcafeb6(0x1b8)](PTERODACTYL_API_URL+_0xcafeb6(0x193)+_0x354b9c+_0xcafeb6(0x19e),{},{'headers':{'Accept':'application/json','Content-Type':_0xcafeb6(0x171),'Authorization':_0xcafeb6(0x181)+PTERODACTYL_API_KEY,'Cookie':PTERODACTYL_SESSION_COOKIE}}),console[_0xcafeb6(0x1c1)](_0xcafeb6(0x1c7)+_0x354b9c+_0xcafeb6(0x18b));}catch(_0x375c5e){console[_0xcafeb6(0x1c5)]('Error\x20suspending\x20server\x20'+_0x354b9c+':',_0x375c5e);}}async function sendPublicAlert(_0x787316,_0x396a8f){const _0x117586=_0x5d7909,_0x38e930={'title':'Suspicious\x20activity\x20detected\x20by\x20Radar.','color':0x5046e4,'fields':[{'name':'Container','value':_0x396a8f||_0x117586(0x177),'inline':![]}],'timestamp':new Date()[_0x117586(0x19c)](),'footer':_0x117586(0x17e)},_0x48d6cd={'embeds':[_0x38e930]};try{await axios[_0x117586(0x1b8)](PUBLIC_WEBHOOK_URL,_0x48d6cd),console[_0x117586(0x1c1)]('Sent\x20public\x20alert\x20for\x20container\x20'+_0x787316);}catch(_0x1d518c){console['error'](_0x117586(0x15b)+_0x787316+':',_0x1d518c);}}async function sendPrivateAlert(_0xb0ef47,_0x3928cc,_0x150de5){const _0x1447af=_0x5d7909,_0x340490={'title':_0x1447af(0x1cf)+_0x3928cc+']','color':0x5046e4,'fields':[{'name':'Docker\x20UUID','value':_0xb0ef47,'inline':!![]},{'name':_0x1447af(0x1b5),'value':_0x3928cc||_0x1447af(0x177),'inline':!![]},{'name':_0x1447af(0x15a),'value':_0x150de5['join']('\x0a')}],'footer':{'text':_0x1447af(0x1b0)},'timestamp':new Date()[_0x1447af(0x19c)]()},_0x5306ee={'embeds':[_0x340490]};try{await axios[_0x1447af(0x1b8)](PRIVATE_WEBHOOK_URL,_0x5306ee),console['log']('Sent\x20private\x20alert\x20for\x20container\x20'+_0xb0ef47);}catch(_0x4eba2c){console[_0x1447af(0x1c5)]('Error\x20sending\x20private\x20alert\x20for\x20container\x20'+_0xb0ef47+':',_0x4eba2c);}}async function loadStrategies(){const _0x59e55f=_0x5d7909,_0x3cb880=[];try{const _0x18074e=await fs[_0x59e55f(0x189)](STRATEGIES_DIR);for(const _0xaf9420 of _0x18074e){if(_0xaf9420['endsWith']('.radar')){const _0x1989bf=path[_0x59e55f(0x160)](STRATEGIES_DIR,_0xaf9420);try{const _0x321493=await fs[_0x59e55f(0x1d4)](_0x1989bf,_0x59e55f(0x17d)),_0x1976ef=JSON['parse'](_0x321493);if(!_0x1976ef[_0x59e55f(0x14e)]||!_0x1976ef[_0x59e55f(0x152)]||!Array[_0x59e55f(0x174)](_0x1976ef[_0x59e55f(0x14f)])){console[_0x59e55f(0x1a5)]('Invalid\x20strategy\x20structure\x20in\x20file\x20'+_0xaf9420+_0x59e55f(0x19b));continue;}_0x3cb880[_0x59e55f(0x159)](_0x1976ef),console[_0x59e55f(0x1c1)](_0x59e55f(0x182)+_0x1976ef[_0x59e55f(0x14e)]+'\x20from\x20'+_0xaf9420);}catch(_0xde8b78){console[_0x59e55f(0x1c5)]('Error\x20loading\x20strategy\x20from\x20'+_0xaf9420+':',_0xde8b78);}}}}catch(_0x54032a){console[_0x59e55f(0x1c5)]('Error\x20reading\x20strategies\x20directory:',_0x54032a);}return _0x3cb880[_0x59e55f(0x1d5)]===0x0?console[_0x59e55f(0x1a5)](_0x59e55f(0x146)):console[_0x59e55f(0x1c1)](_0x59e55f(0x1cb)+_0x3cb880['length']+_0x59e55f(0x1d0)),_0x3cb880;}function _0x5d76(){const _0x4504cf=['Executing\x20strategy:\x20','includes','strategies','panel','.\x20Skipping.','toISOString','3693102XWJFUV','/suspend','basename','readFileSync','parse','writeFile','createHash','Error\x20checking\x20container\x20processes:','warn','Package.json\x20not\x20found\x20at\x20','createReadStream','logs','exec','dependencies','Error\x20executing\x20check\x20','Error\x20checking\x20container\x20network\x20usage:','flagged.json','1475YPMqjB','Error\x20parsing\x20package.json\x20at\x20','©\x20SRYDEN,\x20Inc.','file','dockerode','volumes_dir','Error\x20in\x20scan\x20cycle:','Panel\x20Server\x20ID','devDependencies','Error\x20in\x20anti-abuse\x20script:','post','end','key','{filename}','object','digest','Invalid\x20checks\x20array\x20in\x20strategy\x20','processes','Invalid\x20check\x20configuration:\x20threshold\x20is\x20undefined\x20for\x20container\x20','log','trim','Invalid\x20check\x20configuration\x20in\x20strategy\x20','\x20in\x20strategy\x20','error','uuid','Server\x20','\x20for\x20volume\x20','reduce','fs-extra','Loaded\x20','get','Error\x20fetching\x20server\x20data:','message','Incident\x20[','\x20strategies\x20successfully.','existsSync','log_content','toFixed','readFile','length','9815113dLBCxG','dependency','18562095vvVpKR','Invalid\x20check\x20configuration:\x20path\x20or\x20max_size\x20is\x20undefined\x20for\x20volume\x20','Error\x20processing\x20volume\x20','No\x20valid\x20strategies\x20loaded.\x20Check\x20your\x20.radar\x20files\x20and\x20permissions.','catch','networks','crypto','axios','tx_bytes','patterns','2662712cQxAqI','name','checks','process_check','Error\x20checking\x20file\x20existence\x20for\x20','type','Invalid\x20check\x20configuration:\x20path\x20is\x20undefined\x20for\x20volume\x20','Starting\x20continuous\x20container\x20abuse\x20detection...','toLowerCase','Container\x20','2523268bLvFNi','data','push','All\x20Flags','Error\x20sending\x20public\x20alert\x20for\x20container\x20','getContainer','max_size','/api/application','file_existence','join','network_usage','{pattern}','Error\x20checking\x20container\x20logs:','./config.json','Invalid\x20check\x20configuration:\x20path\x20or\x20patterns\x20is\x20undefined\x20for\x20volume\x20','/var/lib/pterodactyl/volumes','Path\x20is\x20undefined\x20for\x20','1runceN','file_content','{dependency}','\x20seconds\x20before\x20next\x20scan...','pattern','stringify','3892UFlJvS','Unspecified\x20issue\x20detected','\x20on\x20volume\x20','application/json','package_check','Invalid\x20file\x20check\x20type:\x20','isArray','filter','package.json','Unknown','Invalid\x20check\x20configuration:\x20command\x20or\x20cpu_threshold\x20is\x20undefined\x20for\x20container\x20','\x20already\x20flagged.\x20Skipping...','toString','usage','Volume\x20directory\x20for\x20','utf-8','Powered\x20by\x20https://radar.sryden.com','Unknown\x20check\x20type:\x20','values','Bearer\x20','Loaded\x20strategy:\x20','start','/servers?per_page=50000','path','keys','replace','\x20check\x20in\x20strategy\x20','readdir','File\x20is\x20undefined\x20for\x20dependency\x20check\x20in\x20strategy\x20','\x20suspended\x20successfully.','\x20does\x20not\x20exist.\x20Skipping...','attributes','3529962wXHQwe','rx_bytes','{usage}','\x20for\x20strategy\x20','Completed\x20scan.\x20Waiting\x20','/servers/','command','threshold','split'];_0x5d76=function(){return _0x4504cf;};return _0x5d76();}async function executeStrategy(_0x31ee91,_0x1606ac,_0x2a0669){const _0x24f41e=_0x5d7909,_0x555c39=[];console[_0x24f41e(0x1c1)](_0x24f41e(0x197)+_0x31ee91['name']+'\x20for\x20volume\x20'+_0x1606ac);if(!Array[_0x24f41e(0x174)](_0x31ee91['checks']))return console[_0x24f41e(0x1a5)](_0x24f41e(0x1be)+_0x31ee91['name']+'\x20for\x20volume\x20'+_0x1606ac),_0x555c39;for(const _0xa26d92 of _0x31ee91[_0x24f41e(0x14f)]){if(!_0xa26d92||typeof _0xa26d92!==_0x24f41e(0x1bc)||!_0xa26d92[_0x24f41e(0x152)]){console[_0x24f41e(0x1a5)](_0x24f41e(0x1c3)+_0x31ee91['name']+_0x24f41e(0x1c8)+_0x1606ac);continue;}let _0x23e1aa=![],_0x1245d7=_0xa26d92[_0x24f41e(0x1ce)]||_0x24f41e(0x16f);try{console[_0x24f41e(0x1c1)]('Executing\x20check\x20type:\x20'+_0xa26d92[_0x24f41e(0x152)]+_0x24f41e(0x191)+_0x31ee91['name']+_0x24f41e(0x170)+_0x1606ac);switch(_0xa26d92[_0x24f41e(0x152)]){case'file_existence':case'file_content':case'file_size':_0x23e1aa=await fileCheck(_0x1606ac,_0xa26d92,_0x31ee91[_0x24f41e(0x152)]);break;case _0x24f41e(0x1d7):_0x23e1aa=await dependencyCheck(_0x1606ac,_0xa26d92,_0x31ee91['type']);break;case _0x24f41e(0x1d2):_0x23e1aa=await logContentCheck(_0x2a0669,_0xa26d92);break;case _0x24f41e(0x150):_0x23e1aa=await processCheck(_0x2a0669,_0xa26d92);break;case _0x24f41e(0x161):_0x23e1aa=await networkUsageCheck(_0x2a0669,_0xa26d92);break;default:console[_0x24f41e(0x1a5)](_0x24f41e(0x17f)+_0xa26d92[_0x24f41e(0x152)]+_0x24f41e(0x1c4)+_0x31ee91['name']+_0x24f41e(0x1c8)+_0x1606ac);continue;}_0x23e1aa&&(_0x1245d7=replacePlaceholders(_0x1245d7,_0x23e1aa),_0x555c39[_0x24f41e(0x159)](_0x1245d7),console[_0x24f41e(0x1c1)]('Flag\x20raised:\x20'+_0x1245d7));}catch(_0x13094b){console[_0x24f41e(0x1c5)](_0x24f41e(0x1ab)+_0xa26d92[_0x24f41e(0x152)]+_0x24f41e(0x1c4)+_0x31ee91[_0x24f41e(0x14e)]+'\x20for\x20volume\x20'+_0x1606ac+':',_0x13094b);}}return _0x555c39;}function replacePlaceholders(_0x2fbd66,_0x190b93){const _0x5a854a=_0x5d7909;return _0x2fbd66['replace'](_0x5a854a(0x162),_0x190b93[_0x5a854a(0x16c)]||'')[_0x5a854a(0x187)](_0x5a854a(0x1bb),_0x190b93['filename']||'')['replace'](_0x5a854a(0x16a),_0x190b93[_0x5a854a(0x1d7)]||'')[_0x5a854a(0x187)](_0x5a854a(0x190),_0x190b93[_0x5a854a(0x17b)]?(_0x190b93[_0x5a854a(0x17b)]/0x400/0x400)[_0x5a854a(0x1d3)](0x2):'')[_0x5a854a(0x187)]('{processes}',_0x190b93[_0x5a854a(0x1bf)]?_0x190b93[_0x5a854a(0x1bf)][_0x5a854a(0x160)](',\x20'):'');}async function fileCheck(_0x3a2b82,_0x11f583,_0x2686e2){const _0x215f57=_0x5d7909;if(!_0x11f583[_0x215f57(0x185)]&&_0x2686e2!=='file_check')return console[_0x215f57(0x1a5)](_0x215f57(0x167)+_0x11f583[_0x215f57(0x152)]+_0x215f57(0x188)+_0x2686e2+_0x215f57(0x1c8)+_0x3a2b82),![];const _0x1cff07=_0x2686e2==='file_check'?path[_0x215f57(0x160)](_0x3a2b82,_0x11f583[_0x215f57(0x185)]||''):_0x11f583[_0x215f57(0x185)];switch(_0x11f583[_0x215f57(0x152)]){case _0x215f57(0x15f):return fileExistenceCheck(_0x1cff07,_0x11f583);case _0x215f57(0x169):return fileContentCheck(_0x1cff07,_0x11f583);case'file_size':return fileSizeCheck(_0x1cff07,_0x11f583);default:throw new Error(_0x215f57(0x173)+_0x11f583[_0x215f57(0x152)]);}}async function fileExistenceCheck(_0x26b168,_0xe43d9c){const _0x39971d=_0x5d7909;if(!_0xe43d9c['path'])return console[_0x39971d(0x1a5)](_0x39971d(0x153)+_0x26b168),![];const _0x4b1469=path[_0x39971d(0x160)](_0x26b168,_0xe43d9c[_0x39971d(0x185)]);if(_0xe43d9c[_0x39971d(0x14c)]){try{for(const _0x28d39 of _0xe43d9c['patterns']){const _0x3c84c1=await glob(path['join'](_0x4b1469,_0x28d39));if(_0x3c84c1[_0x39971d(0x1d5)]>0x0)return{'filename':path[_0x39971d(0x19f)](_0x3c84c1[0x0])};}}catch(_0x11c887){console['error'](_0x39971d(0x151)+_0x4b1469+':',_0x11c887);}return![];}else try{return fs[_0x39971d(0x1d1)](_0x4b1469);}catch(_0x59850b){return console[_0x39971d(0x1c5)]('Error\x20checking\x20file\x20existence\x20for\x20'+_0x4b1469+':',_0x59850b),![];}}async function fileContentCheck(_0x43572f,_0xf6bf3d){const _0x11cff2=_0x5d7909;if(!_0xf6bf3d[_0x11cff2(0x185)]||!_0xf6bf3d[_0x11cff2(0x14c)])return console[_0x11cff2(0x1a5)](_0x11cff2(0x165)+_0x43572f),![];const _0x56c619=path[_0x11cff2(0x160)](_0x43572f,_0xf6bf3d[_0x11cff2(0x185)]);if(fs['existsSync'](_0x56c619)){const _0x2bfc7d=await fs[_0x11cff2(0x1d4)](_0x56c619,_0x11cff2(0x17d));for(const _0x58c520 of _0xf6bf3d[_0x11cff2(0x14c)]){if(_0x2bfc7d['includes'](_0x58c520))return{'pattern':_0x58c520};}}return![];}async function fileSizeCheck(_0x3260b5,_0x172aa0){const _0x86549a=_0x5d7909;if(!_0x172aa0['path']||!_0x172aa0['max_size'])return console['warn'](_0x86549a(0x144)+_0x3260b5),![];const _0x46d9a1=path[_0x86549a(0x160)](_0x3260b5,_0x172aa0['path']);if(fs['existsSync'](_0x46d9a1)){const _0x1252ec=await fs['stat'](_0x46d9a1);return _0x1252ec['size']<_0x172aa0[_0x86549a(0x15d)];}return![];}function _0x17de(_0x905606,_0x37a153){const _0x5d76f4=_0x5d76();return _0x17de=function(_0x17de48,_0xbaeee9){_0x17de48=_0x17de48-0x144;let _0x5bcade=_0x5d76f4[_0x17de48];return _0x5bcade;},_0x17de(_0x905606,_0x37a153);}async function dependencyCheck(_0x344406,_0x2f6a68,_0x5825f){const _0x2fc8ec=_0x5d7909;if(!_0x2f6a68['file']&&_0x5825f!==_0x2fc8ec(0x172))return console['warn'](_0x2fc8ec(0x18a)+_0x5825f+_0x2fc8ec(0x1c8)+_0x344406),![];const _0x18fcbd=_0x5825f===_0x2fc8ec(0x172)?path['join'](_0x344406,_0x2f6a68[_0x2fc8ec(0x1b1)]||_0x2fc8ec(0x176)):_0x2f6a68['file'];if(!fs['existsSync'](_0x18fcbd))return console[_0x2fc8ec(0x1c1)](_0x2fc8ec(0x1a6)+_0x18fcbd),![];try{const _0x1653cf=JSON['parse'](await fs[_0x2fc8ec(0x1d4)](_0x18fcbd,_0x2fc8ec(0x17d))),_0x122511={..._0x1653cf[_0x2fc8ec(0x1aa)],..._0x1653cf[_0x2fc8ec(0x1b6)]};for(const _0x231a85 of _0x2f6a68[_0x2fc8ec(0x14c)]){const _0x249ec4=Object[_0x2fc8ec(0x186)](_0x122511)['find'](_0x5153e9=>_0x5153e9[_0x2fc8ec(0x155)]()[_0x2fc8ec(0x198)](_0x231a85[_0x2fc8ec(0x155)]()));if(_0x249ec4)return{'dependency':_0x249ec4};}}catch(_0x195885){console[_0x2fc8ec(0x1c5)](_0x2fc8ec(0x1af)+_0x18fcbd+':',_0x195885);}return![];}async function logContentCheck(_0x255221,_0x160b6b){const _0x179e45=_0x5d7909;if(!_0x160b6b['patterns'])return console[_0x179e45(0x1a5)]('Invalid\x20check\x20configuration:\x20patterns\x20is\x20undefined\x20for\x20container\x20'+_0x255221['id']),![];try{const _0x4d5357=await _0x255221[_0x179e45(0x1a8)]({'stdout':!![],'stderr':!![],'tail':0x3e8}),_0x2c1e09=_0x4d5357[_0x179e45(0x17a)](_0x179e45(0x17d));for(const _0x1afd0a of _0x160b6b[_0x179e45(0x14c)]){if(_0x2c1e09[_0x179e45(0x155)]()[_0x179e45(0x198)](_0x1afd0a['toLowerCase']()))return{'pattern':_0x1afd0a};}}catch(_0x3deb23){console[_0x179e45(0x1c5)](_0x179e45(0x163),_0x3deb23);}return![];}async function processCheck(_0x536864,_0x2a9f6a){const _0x5407f1=_0x5d7909;if(!_0x2a9f6a[_0x5407f1(0x194)]||!_0x2a9f6a['cpu_threshold'])return console['warn'](_0x5407f1(0x178)+_0x536864['id']),![];try{const _0x24b1d5=await _0x536864[_0x5407f1(0x1a9)]({'Cmd':['sh','-c',_0x2a9f6a[_0x5407f1(0x194)]],'AttachStdout':!![],'AttachStderr':!![]}),_0x216e8d=await _0x24b1d5[_0x5407f1(0x183)](),_0x5f35a7=await new Promise(_0x1260a4=>{const _0x1d62e3=_0x5407f1;let _0x265b93='';_0x216e8d['on'](_0x1d62e3(0x158),_0x75d7b=>_0x265b93+=_0x75d7b[_0x1d62e3(0x17a)]()),_0x216e8d['on']('end',()=>_0x1260a4(_0x265b93));}),_0x3932ce=_0x5f35a7[_0x5407f1(0x196)]('\x0a')[_0x5407f1(0x175)](_0x28d5c7=>{const _0x1521e0=_0x5407f1,_0x4f619f=_0x28d5c7[_0x1521e0(0x1c2)]()['split'](/\s+/);if(_0x4f619f['length']>0x8){const _0x4e35c2=parseFloat(_0x4f619f[0x8]);return!isNaN(_0x4e35c2)&&_0x4e35c2>_0x2a9f6a['cpu_threshold'];}return![];});return _0x3932ce[_0x5407f1(0x1d5)]>0x0?{'processes':_0x3932ce}:![];}catch(_0x143cbf){return console[_0x5407f1(0x1c5)](_0x5407f1(0x1a4),_0x143cbf),![];}}async function networkUsageCheck(_0x452179,_0x4771e6){const _0x8e380e=_0x5d7909;if(!_0x4771e6[_0x8e380e(0x195)])return console[_0x8e380e(0x1a5)](_0x8e380e(0x1c0)+_0x452179['id']),![];try{const _0x1ddcfb=await _0x452179['stats']({'stream':![]}),_0x229b92=_0x1ddcfb[_0x8e380e(0x148)]&&Object[_0x8e380e(0x180)](_0x1ddcfb['networks'])[_0x8e380e(0x1c9)]((_0x288b38,_0x2d1631)=>_0x288b38+_0x2d1631[_0x8e380e(0x18f)]+_0x2d1631[_0x8e380e(0x14b)],0x0);return _0x229b92>_0x4771e6[_0x8e380e(0x195)]?{'usage':_0x229b92}:![];}catch(_0x39b4ed){return console[_0x8e380e(0x1c5)](_0x8e380e(0x1ac),_0x39b4ed),![];}}async function checkVolume(_0x5019a2,_0x132c3b){const _0x127065=_0x5d7909,_0x529142=path[_0x127065(0x160)](VOLUMES_DIR,_0x5019a2),_0x558a13=[];if(!fs['existsSync'](_0x529142))return console[_0x127065(0x1c1)](_0x127065(0x17c)+_0x5019a2+_0x127065(0x18c)),_0x558a13;const _0xec94c6=docker[_0x127065(0x15c)](_0x5019a2);for(const _0x162005 of _0x132c3b){const _0x222ab0=await executeStrategy(_0x162005,_0x529142,_0xec94c6);_0x558a13[_0x127065(0x159)](..._0x222ab0);}return _0x558a13;}async function scanAllContainers(_0x347fb4){const _0x44fdb7=_0x5d7909,_0x2e651e=await fs[_0x44fdb7(0x189)](VOLUMES_DIR);for(const _0x362e46 of _0x2e651e){if(flaggedContainers[_0x362e46]){console['log'](_0x44fdb7(0x156)+_0x362e46+_0x44fdb7(0x179));continue;}try{const _0x20fafa=await checkVolume(_0x362e46,_0x347fb4);if(_0x20fafa[_0x44fdb7(0x1d5)]>0x0){const _0x463e06=await getServerIdFromUUID(_0x362e46);_0x463e06&&await suspendServer(_0x463e06),await sendPublicAlert(_0x362e46,_0x463e06),await sendPrivateAlert(_0x362e46,_0x463e06,_0x20fafa),flaggedContainers[_0x362e46]=!![],await fs[_0x44fdb7(0x1a2)](FLAGGED_CONTAINERS_FILE,JSON[_0x44fdb7(0x16d)](flaggedContainers));}}catch(_0x526ca9){console[_0x44fdb7(0x1c5)](_0x44fdb7(0x145)+_0x362e46+':',_0x526ca9);}}}async function main(){const _0x1c6c64=_0x5d7909;console['log'](_0x1c6c64(0x154));const _0x52d589=await loadStrategies();while(!![]){try{await scanAllContainers(_0x52d589),console[_0x1c6c64(0x1c1)](_0x1c6c64(0x192)+SCAN_INTERVAL/0x3e8+_0x1c6c64(0x16b));}catch(_0xa07132){console[_0x1c6c64(0x1c5)](_0x1c6c64(0x1b4),_0xa07132);}finally{await new Promise(_0x25e131=>setTimeout(_0x25e131,SCAN_INTERVAL));}}}main()[_0x5d7909(0x147)](_0x2149c2=>console[_0x5d7909(0x1c5)](_0x5d7909(0x1b7),_0x2149c2));
